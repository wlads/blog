<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: S3 | Blog da HE:labs]]></title>
  <link href="http://helabs.com.br/blog/categories/s3/atom.xml" rel="self"/>
  <link href="http://helabs.com.br/blog/"/>
  <updated>2013-08-30T10:44:41-03:00</updated>
  <id>http://helabs.com.br/blog/</id>
  <author>
    <name><![CDATA[Time HE:labs]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Protegendo seus buckets do S3 com chaves IAM]]></title>
    <link href="http://helabs.com.br/blog/2013/05/09/protegendo-seus-buckets-do-s3-com-chaves-iam/"/>
    <updated>2013-05-09T11:00:00-03:00</updated>
    <id>http://helabs.com.br/blog/2013/05/09/protegendo-seus-buckets-do-s3-com-chaves-iam</id>
    <content type="html"><![CDATA[<p><img src="/images/posts/2013-05-08/bucket.jpg" alt="image" /></p>

<p>Você usa <strong>buckets</strong> do S3 para armazenar os uploads e assets da sua aplicação?</p>

<p>A maioria das pessoas usam os mesmos dados de acesso (<em>access key</em> e <em>secret access key</em>) para acessar o(s) bucket(s), tanto em desenvolvimento quanto em produção.</p>

<p>Isso pode trazer alguns problemas para a aplicação...</p>

<!-- more -->


<p>Como:</p>

<ul>
<li>Os dados de acesso ao bucket (e provavelmente à conta do AWS) estão presentes nos arquivos de configuração;</li>
<li>O bucket acessado (e bombardeado com arquivos de testes) é o mesmo bucket usado em produção;</li>
<li>Não há nenhum tipo de restrição, quem estiver trabalhando no desenvolvimento do projeto terá acesso ao bucket com os arquivos de produção.</li>
</ul>


<p>A solução para todos os problemas acima é restringir o acesso aos buckets, separando os dados de acesso (chaves) de cada um:</p>

<h1>Crie dois buckets</h1>

<p>Não há nada de misterioso ou novo aqui, apenas crie dois buckets:</p>

<ul>
<li>Um bucket para desenvolvimento: <strong>meuprojeto-development</strong></li>
<li>Um bucket para production: <strong>meuprojeto-produciton</strong></li>
</ul>


<h1>Crie dois usuários IAM</h1>

<p>Agora você precisa criar dois usuários (pra facilitar, com o mesmo nome dos buckets):</p>

<p><img src="/images/posts/2013-05-08/iam-new-user.png" alt="image" /></p>

<p><img src="/images/posts/2013-05-08/iam-new-users.png" alt="image" /></p>

<p>Não se esqueça de anotar as chaves de acesso de cada usuário:</p>

<p><img src="/images/posts/2013-05-08/iam-credentials.png" alt="image" /></p>

<h1>Defina as regras de acesso</h1>

<p>Agora que os usuários estão criados, precisamos definir permissões de acesso.</p>

<p>Marque um usuário. Para isso, vá em <strong>Permissions</strong> > <strong>Attach User Policy</strong> > Custom Policy.</p>

<p>Dê um nome pra regra e use o seguinte template:</p>

<p>```json
{
  "Statement": [</p>

<pre><code>{
  "Sid": "Stmt1368030337093",
  "Action": [
    "s3:*"
  ],
  "Effect": "Allow",
  "Resource": [
    "arn:aws:s3:::NOME_DO_BUCKET/*"
  ]
}
</code></pre>

<p>  ]
}
```</p>

<p>Substitua <strong>NOME_DO_BUCKET</strong> pelo nome do bucket criado anteriormente e crie essa regra para o bucket de cada usuário.</p>

<h1>Conclusão</h1>

<p>Agora você tem dois buckets com acessos separados, um para desenvolvimento e um para produção.</p>

<p>Espero que tenham gostado, e até a próxima! :)</p>
]]></content>
  </entry>
  
</feed>
